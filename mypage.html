<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>高级彩票开奖后台管理系统</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary: #1e3a8a;
            --secondary: #2d4cc8;
            --accent: #ff6b6b;
            --dark: #0f172a;
            --darker: #0a0f1f;
            --light: #e2e8f0;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --info: #3b82f6;
            --dragon: #ff6b6b;
            --tiger: #3b82f6;
            --tie: #10b981;
            --odd: #f59e0b;
            --even: #8b5cf6;
            --big: #0ea5e9;
            --small: #ec4899;
            --total: #14b8a6;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, var(--darker), var(--dark));
            color: var(--light);
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        .container {
            display: flex;
            min-height: 100vh;
        }
        
        /* 侧边栏样式 */
        .sidebar {
            width: 250px;
            background: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(10px);
            padding: 20px 0;
            border-right: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
            position: relative;
            z-index: 100;
            overflow-y: auto;
            max-height: 100vh;
        }
        
        .logo {
            display: flex;
            align-items: center;
            padding: 0 20px 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .logo i {
            font-size: 28px;
            color: var(--accent);
            margin-right: 12px;
        }
        
        .logo h1 {
            font-size: 22px;
            font-weight: 700;
            background: linear-gradient(90deg, var(--accent), var(--info));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        
        .nav-links {
            margin-top: 30px;
        }
        
        .nav-item {
            display: flex;
            align-items: center;
            padding: 14px 20px;
            margin: 5px 0;
            border-left: 4px solid transparent;
            transition: all 0.3s;
            cursor: pointer;
            position: relative;
        }
        
        .nav-item:hover, .nav-item.active {
            background: rgba(45, 76, 200, 0.2);
            border-left: 4px solid var(--info);
        }
        
        .nav-item .notification {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            background: var(--accent);
            color: white;
            border-radius: 50%;
            width: 22px;
            height: 22px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 600;
        }
        
        .nav-item i {
            font-size: 20px;
            margin-right: 12px;
            width: 24px;
            text-align: center;
        }
        
        /* 主内容区 */
        .main-content {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            position: relative;
        }
        
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .header h2 {
            font-size: 24px;
            font-weight: 600;
            display: flex;
            align-items: center;
        }
        
        .header h2 i {
            margin-right: 10px;
            color: var(--accent);
        }
        
        .user-info {
            display: flex;
            align-items: center;
            position: relative;
        }
        
        .user-info img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            margin-right: 10px;
            object-fit: cover;
            border: 2px solid var(--info);
        }
        
        /* 卡片样式 */
        .card {
            background: rgba(15, 23, 42, 0.85);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 25px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 20px rgba(0, 0, 0, 0.4);
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .card-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--accent);
        }
        
        .card-actions {
            display: flex;
            gap: 10px;
        }
        
        /* 开奖管理 */
        .draw-controls {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .draw-input {
            flex: 1;
            display: flex;
            flex-direction: column;
            min-width: 200px;
        }
        
        .draw-input label {
            margin-bottom: 8px;
            font-size: 14px;
            color: var(--light);
        }
        
        .draw-input input {
            padding: 12px 15px;
            background: rgba(10, 15, 31, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            color: var(--light);
            font-size: 16px;
            outline: none;
            transition: all 0.3s;
        }
        
        .draw-input input:focus {
            border-color: var(--info);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.3);
        }
        
        .draw-input .error {
            color: var(--danger);
            font-size: 13px;
            margin-top: 5px;
            display: none;
        }
        
        .btn {
            padding: 12px 25px;
            border-radius: 8px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-size: 14px;
        }
        
        .btn-sm {
            padding: 8px 15px;
            font-size: 13px;
        }
        
        .btn-primary {
            background: var(--secondary);
            color: white;
        }
        
        .btn-primary:hover {
            background: var(--info);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        .btn-outline {
            background: transparent;
            border: 1px solid var(--info);
            color: var(--info);
        }
        
        .btn-outline:hover {
            background: rgba(59, 130, 246, 0.15);
        }
        
        .btn-danger {
            background: var(--danger);
            color: white;
        }
        
        .btn-danger:hover {
            background: #dc2626;
            transform: translateY(-2px);
        }
        
        .btn-success {
            background: var(--success);
            color: white;
        }
        
        .btn-success:hover {
            background: #0d9f6e;
        }
        
        .upcoming-draws {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .draw-card {
            background: rgba(10, 15, 31, 0.8);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            border: 1px solid rgba(59, 130, 246, 0.3);
            transition: all 0.3s;
            position: relative;
        }
        
        .draw-card:hover {
            transform: scale(1.03);
        }
        
        .draw-period {
            font-size: 14px;
            color: var(--info);
            margin-bottom: 10px;
        }
        
        .draw-result {
            font-size: 24px;
            font-weight: 700;
            letter-spacing: 3px;
            color: var(--accent);
            min-height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .draw-status {
            display: inline-block;
            padding: 3px 10px;
            border-radius: 20px;
            font-size: 12px;
            margin-top: 8px;
        }
        
        .status-pending {
            background: rgba(245, 158, 11, 0.2);
            color: var(--warning);
        }
        
        .status-completed {
            background: rgba(16, 185, 129, 0.2);
            color: var(--success);
        }
        
        /* 赔率计算器 */
        .bet-controls {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }
        
        .bet-input {
            display: flex;
            flex-direction: column;
        }
        
        .bet-input label {
            margin-bottom: 8px;
            font-size: 14px;
            display: flex;
            align-items: center;
        }
        
        .bet-input label i {
            margin-right: 8px;
            font-size: 18px;
        }
        
        .bet-input .input-group {
            display: flex;
        }
        
        .bet-input .input-group input {
            flex: 1;
            padding: 12px 15px;
            background: rgba(10, 15, 31, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px 0 0 8px;
            color: var(--light);
            font-size: 16px;
            outline: none;
        }
        
        .bet-input .input-group .odds-btn {
            padding: 12px 15px;
            background: rgba(15, 23, 42, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-left: none;
            border-radius: 0 8px 8px 0;
            color: var(--light);
            cursor: pointer;
            transition: all 0.3s;
            min-width: 60px;
            text-align: center;
        }
        
        .bet-input .input-group .odds-btn:hover {
            background: rgba(45, 76, 200, 0.2);
        }
        
        .payout-display {
            font-size: 13px;
            color: var(--danger);
            margin-top: 5px;
            min-height: 20px;
        }
        
        /* 开奖建议 */
        .suggestion-box {
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid var(--success);
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }
        
        .suggestion-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .suggestion-header i {
            font-size: 24px;
            color: var(--success);
            margin-right: 10px;
        }
        
        .profit-loss {
            display: flex;
            gap: 20px;
            margin-top: 15px;
        }
        
        .profit-box, .loss-box {
            flex: 1;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }
        
        .profit-box {
            background: rgba(16, 185, 129, 0.15);
            border: 1px solid var(--success);
        }
        
        .loss-box {
            background: rgba(239, 68, 68, 0.15);
            border: 1px solid var(--danger);
        }
        
        /* 结果详情 */
        .result-details {
            margin-top: 20px;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 15px;
        }
        
        .result-card {
            background: rgba(10, 15, 31, 0.8);
            border-radius: 8px;
            padding: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s;
            position: relative;
        }
        
        .result-card.recommended {
            background: rgba(16, 185, 129, 0.15);
            border: 2px solid var(--success);
            transform: scale(1.05);
            box-shadow: 0 0 15px rgba(16, 185, 129, 0.3);
        }
        
        .result-card .result-title {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
            font-weight: 600;
        }
        
        .result-card .result-title i {
            margin-right: 8px;
            font-size: 20px;
        }
        
        .result-card .profit {
            font-size: 18px;
            font-weight: 700;
            margin-top: 5px;
        }
        
        .profit.positive {
            color: var(--success);
        }
        
        .profit.negative {
            color: var(--danger);
        }
        
        .result-card .loss {
            font-size: 14px;
            margin-top: 5px;
            color: var(--danger);
        }
        
        .badge {
            position: absolute;
            top: 10px;
            right: 10px;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .badge.recommended {
            background: var(--success);
            color: white;
        }
        
        .badge.warning {
            background: var(--warning);
            color: white;
        }
        
        .badge.danger {
            background: var(--danger);
            color: white;
        }
        
        /* 图表区域 */
        .chart-container {
            height: 300px;
            margin-top: 20px;
            position: relative;
        }
        
        /* 响应式设计 */
        @media (max-width: 992px) {
            .container {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                padding: 10px;
                height: auto;
                max-height: 70vh;
            }
            
            .nav-links {
                display: flex;
                flex-wrap: wrap;
                gap: 5px;
            }
            
            .nav-item {
                padding: 12px 15px;
                border-left: none;
                border-bottom: 3px solid transparent;
                margin: 0;
                flex: 1 0 auto;
                min-width: calc(50% - 10px);
            }
            
            .nav-item:hover, .nav-item.active {
                border-left: none;
                border-bottom: 3px solid var(--info);
            }
            
            .draw-controls {
                flex-direction: column;
            }
            
            .profit-loss {
                flex-direction: column;
            }
        }
        
        @media (max-width: 768px) {
            .bet-controls, .upcoming-draws, .result-details {
                grid-template-columns: 1fr;
            }
            
            .draw-controls {
                flex-direction: column;
            }
            
            .profit-loss {
                flex-direction: column;
            }
            
            .card-actions {
                flex-wrap: wrap;
                justify-content: flex-end;
            }
            
            .btn {
                padding: 10px 15px;
                font-size: 13px;
            }
            
            .nav-item {
                min-width: 100%;
            }
        }
        
        /* 动画效果 */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        .highlight {
            background: rgba(255, 107, 107, 0.2);
            border: 1px solid var(--accent);
            box-shadow: 0 0 15px rgba(255, 107, 107, 0.4);
        }
        
        /* 赔率选择器 */
        .odds-selector {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
        }
        
        .odds-selector.active {
            opacity: 1;
            visibility: visible;
        }
        
        .odds-panel {
            background: var(--darker);
            border-radius: 12px;
            padding: 30px;
            width: 90%;
            max-width: 600px;
            border: 1px solid var(--info);
            box-shadow: 0 0 30px rgba(59, 130, 246, 0.5);
        }
        
        .odds-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .odds-controls {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 15px;
        }
        
        .odds-input {
            display: flex;
            flex-direction: column;
        }
        
        .odds-input label {
            margin-bottom: 8px;
            display: flex;
            align-items: center;
        }
        
        .odds-input label i {
            margin-right: 8px;
            font-size: 18px;
        }
        
        .odds-input input {
            padding: 12px 15px;
            background: rgba(10, 15, 31, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            color: var(--light);
            font-size: 16px;
            outline: none;
        }
        
        /* 操作反馈 */
        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 8px;
            background: var(--success);
            color: white;
            font-weight: 600;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.3s;
            z-index: 2000;
            display: flex;
            align-items: center;
        }
        
        .toast i {
            margin-right: 10px;
            font-size: 18px;
        }
        
        .toast.show {
            transform: translateY(0);
            opacity: 1;
        }
        
        .toast.error {
            background: var(--danger);
        }
        
        .toast.warning {
            background: var(--warning);
        }
        
        /* 风险指示器 */
        .risk-indicator {
            display: flex;
            align-items: center;
            padding: 10px 15px;
            border-radius: 8px;
            margin-top: 15px;
            background: rgba(239, 68, 68, 0.15);
            border: 1px solid var(--danger);
        }
        
        .risk-indicator i {
            font-size: 24px;
            margin-right: 10px;
            color: var(--danger);
        }
        
        .risk-indicator.low-risk {
            background: rgba(16, 185, 129, 0.15);
            border: 1px solid var(--success);
        }
        
        .risk-indicator.low-risk i {
            color: var(--success);
        }
        
        .risk-indicator.medium-risk {
            background: rgba(245, 158, 11, 0.15);
            border: 1px solid var(--warning);
        }
        
        .risk-indicator.medium-risk i {
            color: var(--warning);
        }
        
        /* 组合结果卡片 */
        .combination-card {
            background: rgba(10, 15, 31, 0.8);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            border: 1px solid rgba(59, 130, 246, 0.3);
        }
        
        .combination-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .combination-title {
            font-weight: 600;
            font-size: 16px;
            color: var(--info);
        }
        
        .combination-values {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 5px;
        }
        
        .combination-value {
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 14px;
            background: rgba(45, 76, 200, 0.2);
        }
        
        /* 统计数据 */
        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .stat-card {
            background: rgba(10, 15, 31, 0.8);
            border-radius: 10px;
            padding: 15px;
            border: 1px solid rgba(59, 130, 246, 0.3);
            text-align: center;
        }
        
        .stat-title {
            font-size: 14px;
            color: var(--light);
            margin-bottom: 8px;
        }
        
        .stat-value {
            font-size: 24px;
            font-weight: 700;
        }
        
        .stat-value.positive {
            color: var(--success);
        }
        
        .stat-value.negative {
            color: var(--danger);
        }
        
        /* 内容面板 */
        .content-panel {
            display: none;
        }
        
        .content-panel.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* 历史记录表格 */
        .history-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        .history-table th {
            background: rgba(45, 76, 200, 0.2);
            padding: 12px;
            text-align: left;
            font-weight: 600;
        }
        
        .history-table td {
            padding: 12px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .history-table tr:hover {
            background: rgba(255, 255, 255, 0.05);
        }
        
        /* 高级过滤器 */
        .filter-container {
            background: rgba(10, 15, 31, 0.8);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .filter-group {
            display: flex;
            flex-direction: column;
            min-width: 200px;
            flex: 1;
        }
        
        .filter-group label {
            margin-bottom: 5px;
            font-size: 14px;
        }
        
        .filter-group select, 
        .filter-group input {
            padding: 10px;
            background: rgba(15, 23, 42, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            color: var(--light);
            font-size: 14px;
        }
        
        /* 移动端菜单按钮 */
        .mobile-menu-btn {
            display: none;
            position: fixed;
            top: 15px;
            left: 15px;
            z-index: 101;
            background: var(--secondary);
            color: white;
            border: none;
            border-radius: 8px;
            width: 40px;
            height: 40px;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            cursor: pointer;
        }
        
        @media (max-width: 992px) {
            .mobile-menu-btn {
                display: flex;
            }
            
            .sidebar {
                position: fixed;
                left: -300px;
                top: 0;
                height: 100vh;
                z-index: 100;
                transition: left 0.3s ease;
            }
            
            .sidebar.active {
                left: 0;
            }
        }
        
        /* 修复小屏幕布局问题 */
        @media (max-width: 480px) {
            .card-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }
            
            .card-actions {
                width: 100%;
                justify-content: flex-start;
            }
            
            .draw-controls > .draw-input {
                min-width: 100%;
            }
            
            .filter-group {
                min-width: 100%;
            }
            
            .btn {
                width: 100%;
            }
        }
        
        .error-message {
            color: var(--danger);
            background: rgba(239, 68, 68, 0.15);
            padding: 10px;
            border-radius: 6px;
            margin-top: 10px;
            display: none;
        }
        
        .confirmation-dialog {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
        }
        
        .confirmation-dialog.active {
            opacity: 1;
            visibility: visible;
        }
        
        .dialog-content {
            background: var(--darker);
            border-radius: 12px;
            padding: 25px;
            width: 90%;
            max-width: 500px;
            text-align: center;
            border: 1px solid var(--info);
        }
        
        .dialog-buttons {
            display: flex;
            gap: 15px;
            margin-top: 25px;
            justify-content: center;
        }
    </style>
</head>
<body>
    <button class="mobile-menu-btn" id="mobileMenuBtn">
        <i class="fas fa-bars"></i>
    </button>
    
    <div class="container">
        <!-- 侧边导航 -->
        <div class="sidebar" id="sidebar">
            <div class="logo">
                <i class="fas fa-crown"></i>
                <h1>彩票开奖管理系统</h1>
            </div>
            
            <div class="nav-links">
                <div class="nav-item active" data-panel="dashboard">
                    <i class="fas fa-tachometer-alt"></i>
                    <span>控制面板</span>
                </div>
                <div class="nav-item" data-panel="drawManagement">
                    <i class="fas fa-dice"></i>
                    <span>开奖管理</span>
                    <div class="notification">3</div>
                </div>
                <div class="nav-item" data-panel="history">
                    <i class="fas fa-history"></i>
                    <span>历史记录</span>
                </div>
                <div class="nav-item" data-panel="analytics">
                    <i class="fas fa-chart-line"></i>
                    <span>数据分析</span>
                    <div class="notification">1</div>
                </div>
                <div class="nav-item" data-panel="dragonAlert">
                    <i class="fas fa-dragon"></i>
                    <span>长龙提醒</span>
                </div>
                <div class="nav-item" data-panel="oddsCalculator">
                    <i class="fas fa-calculator"></i>
                    <span>赔率计算器</span>
                </div>
                <div class="nav-item" data-panel="settings">
                    <i class="fas fa-cog"></i>
                    <span>系统设置</span>
                </div>
            </div>
        </div>
        
        <!-- 主内容区 -->
        <div class="main-content">
            <div class="header">
                <h2><i class="fas fa-tachometer-alt"></i> 控制面板</h2>
                <div class="user-info">
                    <img src="https://ui-avatars.com/api/?name=Admin&background=random" alt="Admin">
                    <span>管理员</span>
                </div>
            </div>
            
            <!-- 控制面板 -->
            <div class="content-panel active" id="dashboard">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">系统概览</div>
                        <div class="card-actions">
                            <button class="btn btn-outline btn-sm">
                                <i class="fas fa-sync-alt"></i> 刷新数据
                            </button>
                            <button class="btn btn-outline btn-sm">
                                <i class="fas fa-download"></i> 导出报表
                            </button>
                        </div>
                    </div>
                    
                    <div class="stats-container">
                        <div class="stat-card">
                            <div class="stat-title">今日总投注量</div>
                            <div class="stat-value positive" id="todayTotalBet">¥ 56,380</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-title">今日盈利</div>
                            <div class="stat-value positive" id="todayProfit">¥ 12,450</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-title">历史总投注量</div>
                            <div class="stat-value" id="totalBetAmount">¥ 2,380,450</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-title">历史总盈利</div>
                            <div class="stat-value positive" id="totalProfit">¥ 583,210</div>
                        </div>
                    </div>
                    
                    <div class="chart-container" style="height: 250px; margin-top: 20px;">
                        <canvas id="profitChart"></canvas>
                    </div>
                </div>
            </div>
            
            <!-- 开奖管理 -->
            <div class="content-panel" id="drawManagement">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">开奖管理</div>
                        <div class="card-actions">
                            <button class="btn btn-outline" id="randomDrawBtn">
                                <i class="fas fa-random"></i> 随机生成
                            </button>
                            <button class="btn btn-primary" id="saveDrawBtn">
                                <i class="fas fa-save"></i> 保存结果
                            </button>
                        </div>
                    </div>
                    
                    <div class="draw-controls">
                        <div class="draw-input">
                            <label>期号设置</label>
                            <input type="text" id="drawPeriod" value="20230615002" readonly>
                        </div>
                        
                        <div class="draw-input">
                            <label>开奖结果 (5位数字)</label>
                            <input type="text" id="drawResult" placeholder="例如: 16846" maxlength="5">
                            <div class="error" id="drawError">请输入5位数字！</div>
                        </div>
                        
                        <div class="draw-input">
                            <label>开奖时间</label>
                            <input type="text" value="2023-06-15 21:45" readonly>
                        </div>
                    </div>
                    
                    <div class="draw-controls">
                        <button class="btn btn-outline" id="addFutureDrawBtn">
                            <i class="fas fa-plus"></i> 添加未来开奖
                        </button>
                        <button class="btn btn-outline" id="batchSetBtn">
                            <i class="fas fa-edit"></i> 批量设置
                        </button>
                        <button class="btn btn-danger" id="clearSettingsBtn">
                            <i class="fas fa-trash"></i> 清空设置
                        </button>
                    </div>
                    
                    <div class="error-message" id="drawErrorMessage"></div>
                    
                    <h3 style="margin: 20px 0 15px; color: var(--info);">即将开奖</h3>
                    <div class="upcoming-draws" id="upcomingDraws">
                        <!-- 由JS动态生成 -->
                    </div>
                </div>
            </div>
            
            <!-- 赔率计算器 -->
            <div class="content-panel" id="oddsCalculator">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">智能赔率计算器</div>
                        <div class="card-actions">
                            <button class="btn btn-primary" id="calculateBtn">
                                <i class="fas fa-calculator"></i> 计算盈利
                            </button>
                            <button class="btn btn-danger" id="clearBetsBtn">
                                <i class="fas fa-trash"></i> 清除投注量
                            </button>
                        </div>
                    </div>
                    
                    <div class="bet-controls">
                        <div class="bet-input">
                            <label><i class="fas fa-dragon" style="color: var(--dragon);"></i> 龙投注量</label>
                            <div class="payout-display" id="dragonPayout">需赔付玩家: ¥0</div>
                            <div class="input-group">
                                <input type="number" id="dragonBet" value="1000">
                                <div class="odds-btn" data-type="dragon">1:0.9</div>
                            </div>
                        </div>
                        <div class="bet-input">
                            <label><i class="fas fa-paw" style="color: var(--tiger);"></i> 虎投注量</label>
                            <div class="payout-display" id="tigerPayout">需赔付玩家: ¥0</div>
                            <div class="input-group">
                                <input type="number" id="tigerBet" value="186">
                                <div class="odds-btn" data-type="tiger">1:0.9</div>
                            </div>
                        </div>
                        <div class="bet-input">
                            <label><i class="fas fa-link" style="color: var(--tie);"></i> 和投注量</label>
                            <div class="payout-display" id="tiePayout">需赔付玩家: ¥0</div>
                            <div class="input-group">
                                <input type="number" id="tieBet" value="32">
                                <div class="odds-btn" data-type="tie">1:0.9</div>
                            </div>
                        </div>
                        <div class="bet-input">
                            <label><i class="fas fa-mars" style="color: var(--odd);"></i> 单投注量</label>
                            <div class="payout-display" id="oddPayout">需赔付玩家: ¥0</div>
                            <div class="input-group">
                                <input type="number" id="oddBet" value="890">
                                <div class="odds-btn" data-type="odd">1:0.9</div>
                            </div>
                        </div>
                        <div class="bet-input">
                            <label><i class="fas fa-venus" style="color: var(--even);"></i> 双投注量</label>
                            <div class="payout-display" id="evenPayout">需赔付玩家: ¥0</div>
                            <div class="input-group">
                                <input type="number" id="evenBet" value="65">
                                <div class="odds-btn" data-type="even">1:0.9</div>
                            </div>
                        </div>
                        <div class="bet-input">
                            <label><i class="fas fa-arrow-up" style="color: var(--big);"></i> 大投注量</label>
                            <div class="payout-display" id="bigPayout">需赔付玩家: ¥0</div>
                            <div class="input-group">
                                <input type="number" id="bigBet" value="154">
                                <div class="odds-btn" data-type="big">1:0.9</div>
                            </div>
                        </div>
                        <div class="bet-input">
                            <label><i class="fas fa-arrow-down" style="color: var(--small);"></i> 小投注量</label>
                            <div class="payout-display" id="smallPayout">需赔付玩家: ¥0</div>
                            <div class="input-group">
                                <input type="number" id="smallBet" value="920">
                                <div class="odds-btn" data-type="small">1:0.9</div>
                            </div>
                        </div>
                        <div class="bet-input">
                            <label><i class="fas fa-calculator" style="color: var(--total);"></i> 总和投注量</label>
                            <div class="payout-display" id="totalPayout">需赔付玩家: ¥0</div>
                            <div class="input-group">
                                <input type="number" id="totalBet" value="20">
                                <div class="odds-btn" data-type="total">1:48.5</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="suggestion-box" id="suggestionBox">
                        <div class="suggestion-header">
                            <i class="fas fa-lightbulb"></i>
                            <h3 id="suggestionText">请点击"计算盈利"按钮获取开奖建议</h3>
                        </div>
                        
                        <div class="result-details" id="resultDetails">
                            <!-- 结果卡片由JS动态生成 -->
                        </div>
                        
                        <div id="bestCombination" class="combination-card" style="display: none;">
                            <div class="combination-header">
                                <div class="combination-title">最优开奖组合</div>
                                <div class="badge recommended">推荐</div>
                            </div>
                            <div id="combinationResult"></div>
                            <div style="margin-top: 10px;">
                                <strong>推荐开奖号码: </strong>
                                <span id="recommendedNumber" style="font-size: 18px; font-weight: 700; color: var(--accent);"></span>
                            </div>
                        </div>
                        
                        <div class="profit-loss">
                            <div class="profit-box">
                                <div>预期盈利</div>
                                <div id="expectedProfit" style="font-size: 28px; font-weight: 700; color: var(--success);">¥ 0</div>
                            </div>
                            <div class="loss-box">
                                <div>最大亏损</div>
                                <div id="maxLoss" style="font-size: 28px; font-weight: 700; color: var(--danger);">¥ 0</div>
                            </div>
                        </div>
                        
                        <div id="riskIndicator" class="risk-indicator" style="display: none;">
                            <i class="fas fa-exclamation-triangle"></i>
                            <div id="riskText">高风险警告：所有开奖结果都会导致庄家亏损！</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 数据分析 -->
            <div class="content-panel" id="analytics">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">投注比例分析</div>
                        <div class="card-actions">
                            <button class="btn btn-outline">
                                <i class="fas fa-download"></i> 导出数据
                            </button>
                        </div>
                    </div>
                    
                    <div class="filter-container">
                        <div class="filter-group">
                            <label>时间范围</label>
                            <select id="timeRangeFilter">
                                <option>今日</option>
                                <option>本周</option>
                                <option>本月</option>
                                <option selected>最近7天</option>
                                <option>最近30天</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>彩种</label>
                            <select id="lotteryTypeFilter">
                                <option selected>全部</option>
                                <option>时时彩</option>
                                <option>11选5</option>
                                <option>3D</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>投注类型</label>
                            <select id="betTypeFilter">
                                <option selected>全部</option>
                                <option>龙虎</option>
                                <option>单双</option>
                                <option>大小</option>
                                <option>总和</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="chart-container">
                        <canvas id="bettingChart"></canvas>
                    </div>
                    
                    <div class="error-message" id="analyticsErrorMessage" style="display: none;">
                        <i class="fas fa-exclamation-triangle"></i> 筛选条件无效，请选择其他条件
                    </div>
                </div>
            </div>
            
            <!-- 历史记录 -->
            <div class="content-panel" id="history">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">历史开奖记录</div>
                        <div class="card-actions">
                            <button class="btn btn-outline">
                                <i class="fas fa-filter"></i> 筛选
                            </button>
                            <button class="btn btn-outline">
                                <i class="fas fa-download"></i> 导出
                            </button>
                        </div>
                    </div>
                    
                    <div class="chart-container" style="height: 500px; overflow-y: auto;">
                        <table class="history-table">
                            <thead>
                                <tr>
                                    <th>期号</th>
                                    <th>开奖结果</th>
                                    <th>总投注量</th>
                                    <th>盈利</th>
                                    <th>时间</th>
                                </tr>
                            </thead>
                            <tbody id="historyTable">
                                <!-- 历史记录由JS动态生成 -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 赔率选择器 -->
    <div class="odds-selector" id="oddsSelector">
        <div class="odds-panel">
            <div class="odds-header">
                <h3><i class="fas fa-sliders-h"></i> 赔率设置</h3>
                <div>
                    <button class="btn btn-outline" id="closeOddsBtn">
                        <i class="fas fa-times"></i> 取消
                    </button>
                    <button class="btn btn-primary" id="saveOddsBtn" style="margin-left: 10px;">
                        <i class="fas fa-save"></i> 保存设置
                    </button>
                </div>
            </div>
            
            <div class="odds-controls">
                <div class="odds-input">
                    <label><i class="fas fa-dragon" style="color: var(--dragon);"></i> 龙赔率</label>
                    <input type="text" id="dragonOdds" value="1:0.9">
                </div>
                <div class="odds-input">
                    <label><i class="fas fa-paw" style="color: var(--tiger);"></i> 虎赔率</label>
                    <input type="text" id="tigerOdds" value="1:0.9">
                </div>
                <div class="odds-input">
                    <label><i class="fas fa-link" style="color: var(--tie);"></i> 和赔率</label>
                    <input type="text" id="tieOdds" value="1:8.0">
                </div>
                <div class="odds-input">
                    <label><i class="fas fa-mars" style="color: var(--odd);"></i> 单赔率</label>
                    <input type="text" id="oddOdds" value="1:0.9">
                </div>
                <div class="odds-input">
                    <label><i class="fas fa-venus" style="color: var(--even);"></i> 双赔率</label>
                    <input type="text" id="evenOdds" value="1:0.9">
                </div>
                <div class="odds-input">
                    <label><i class="fas fa-arrow-up" style="color: var(--big);"></i> 大赔率</label>
                    <input type="text" id="bigOdds" value="1:0.9">
                </div>
                <div class="odds-input">
                    <label><i class="fas fa-arrow-down" style="color: var(--small);"></i> 小赔率</label>
                    <input type="text" id="smallOdds" value="1:0.9">
                </div>
                <div class="odds-input">
                    <label><i class="fas fa-calculator" style="color: var(--total);"></i> 总和赔率</label>
                    <input type="text" id="totalOdds" value="1:48.5">
                </div>
            </div>
        </div>
    </div>
    
    <!-- 操作反馈 -->
    <div class="toast" id="toast">
        <i class="fas fa-check-circle"></i>
        <span id="toastText">操作成功</span>
    </div>
    
    <!-- 确认对话框 -->
    <div class="confirmation-dialog" id="confirmationDialog">
        <div class="dialog-content">
            <i class="fas fa-exclamation-circle" style="font-size: 48px; color: var(--warning); margin-bottom: 20px;"></i>
            <h3 id="dialogTitle">确认操作</h3>
            <p id="dialogMessage">您确定要执行此操作吗？</p>
            <div class="dialog-buttons">
                <button class="btn btn-outline" id="dialogCancelBtn">取消</button>
                <button class="btn btn-danger" id="dialogConfirmBtn">确认</button>
            </div>
        </div>
    </div>

    <script>
        // 图表实例
        let bettingChart = null;
        let profitChart = null;
        
        // 初始化数据
        const systemData = {
            todayTotalBet: 56380,
            todayProfit: 12450,
            totalBetAmount: 2380450,
            totalProfit: 583210,
            history: []
        };
        
        const upcomingDraws = [
            { period: '20230615001', result: '16846', status: 'completed' },
            { period: '20230615002', result: '', status: 'next' },
            { period: '20230615003', result: '', status: 'pending' },
            { period: '20230615004', result: '', status: 'pending' },
            { period: '20230615005', result: '', status: 'pending' }
        ];
        
        const odds = {
            dragon: '1:0.9',
            tiger: '1:0.9',
            tie: '1:8.0',
            odd: '1:0.9',
            even: '1:0.9',
            big: '1:0.9',
            small: '1:0.9',
            total: '1:48.5'
        };
        
        // 显示提示信息
        function showToast(message, type = '') {
            const toast = document.getElementById('toast');
            const toastText = document.getElementById('toastText');
            const icon = toast.querySelector('i');
            
            toastText.textContent = message;
            
            if (type === 'error') {
                toast.className = 'toast error show';
                icon.className = 'fas fa-exclamation-circle';
            } else if (type === 'warning') {
                toast.className = 'toast warning show';
                icon.className = 'fas fa-exclamation-triangle';
            } else {
                toast.className = 'toast show';
                icon.className = 'fas fa-check-circle';
            }
            
            setTimeout(() => {
                toast.className = 'toast';
            }, 3000);
        }
        
        // 显示确认对话框
        function showConfirmation(title, message, callback) {
            const dialog = document.getElementById('confirmationDialog');
            document.getElementById('dialogTitle').textContent = title;
            document.getElementById('dialogMessage').textContent = message;
            
            dialog.classList.add('active');
            
            document.getElementById('dialogConfirmBtn').onclick = function() {
                dialog.classList.remove('active');
                if (typeof callback === 'function') {
                    callback();
                }
            };
            
            document.getElementById('dialogCancelBtn').onclick = function() {
                dialog.classList.remove('active');
            };
        }
        
        // 渲染即将开奖区域
        function renderUpcomingDraws() {
            const container = document.getElementById('upcomingDraws');
            container.innerHTML = '';
            
            upcomingDraws.forEach(draw => {
                const drawCard = document.createElement('div');
                drawCard.className = 'draw-card';
                if (draw.status === 'next') drawCard.classList.add('highlight', 'pulse');
                
                drawCard.innerHTML = `
                    <div class="draw-period">${draw.period}</div>
                    <div class="draw-result">${draw.result || '- - - - -'}</div>
                    <div class="draw-status ${draw.status === 'completed' ? 'status-completed' : 'status-pending'}">
                        ${draw.status === 'completed' ? '已开奖' : draw.status === 'next' ? '下一期' : '等待开奖'}
                    </div>
                `;
                
                container.appendChild(drawCard);
            });
        }
        
        // 更新赔付显示
        function updatePayoutDisplay() {
            const types = ['dragon', 'tiger', 'tie', 'odd', 'even', 'big', 'small', 'total'];
            
            types.forEach(type => {
                const betInput = document.getElementById(`${type}Bet`);
                const payoutDisplay = document.getElementById(`${type}Payout`);
                const oddsValue = parseFloat(odds[type].split(':')[1]);
                const betAmount = parseInt(betInput.value) || 0;
                
                // 赔付金额 = 投注量 * (1 + 赔率) 包含本金
                const payout = betAmount * (1 + oddsValue);
                payoutDisplay.textContent = `需赔付玩家: ¥${payout.toLocaleString()}`;
            });
        }
        
        // 初始化图表
        function initChart() {
            const ctx = document.getElementById('bettingChart').getContext('2d');
            
            // 如果已有图表实例，先销毁
            if (bettingChart) {
                bettingChart.destroy();
            }
            
            // 投注数据
            const bettingData = {
                labels: ['龙', '虎', '和', '单', '双', '大', '小', '总和'],
                datasets: [{
                    label: '投注量',
                    data: [
                        parseInt(document.getElementById('dragonBet').value) || 0,
                        parseInt(document.getElementById('tigerBet').value) || 0,
                        parseInt(document.getElementById('tieBet').value) || 0,
                        parseInt(document.getElementById('oddBet').value) || 0,
                        parseInt(document.getElementById('evenBet').value) || 0,
                        parseInt(document.getElementById('bigBet').value) || 0,
                        parseInt(document.getElementById('smallBet').value) || 0,
                        parseInt(document.getElementById('totalBet').value) || 0
                    ],
                    backgroundColor: [
                        'rgba(255, 107, 107, 0.7)',
                        'rgba(59, 130, 246, 0.7)',
                        'rgba(16, 185, 129, 0.7)',
                        'rgba(245, 158, 11, 0.7)',
                        'rgba(139, 92, 246, 0.7)',
                        'rgba(14, 165, 233, 0.7)',
                        'rgba(236, 72, 153, 0.7)',
                        'rgba(20, 184, 166, 0.7)'
                    ],
                    borderColor: [
                        'rgba(255, 107, 107, 1)',
                        'rgba(59, 130, 246, 1)',
                        'rgba(16, 185, 129, 1)',
                        'rgba(245, 158, 11, 1)',
                        'rgba(139, 92, 246, 1)',
                        'rgba(14, 165, 233, 1)',
                        'rgba(236, 72, 153, 1)',
                        'rgba(20, 184, 166, 1)'
                    ],
                    borderWidth: 1
                }]
            };
            
            // 创建图表
            bettingChart = new Chart(ctx, {
                type: 'bar',
                data: bettingData,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            },
                            ticks: {
                                color: 'rgba(255, 255, 255, 0.7)',
                                callback: function(value) {
                                    return '¥' + value.toLocaleString();
                                }
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                color: 'rgba(255, 255, 255, 0.7)'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `投注量: ¥${context.raw.toLocaleString()}`;
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // 生成推荐号码
        function generateRecommendedNumber(combo) {
            // 生成符合组合的随机号码
            let number = '';
            
            // 生成前3位
            for (let i = 0; i < 3; i++) {
                number += Math.floor(Math.random() * 10);
            }
            
            // 根据组合确定后2位
            if (combo.oddEven === 'odd') {
                number += Math.floor(Math.random() * 5) * 2 + 1; // 奇数
            } else {
                number += Math.floor(Math.random() * 5) * 2; // 偶数
            }
            
            // 最后一位用于大小（0-4小，5-9大）
            if (combo.bigSmall === 'big') {
                number += Math.floor(Math.random() * 5) + 5;
            } else {
                number += Math.floor(Math.random() * 5);
            }
            
            return number;
        }
        
        // 计算盈利 - 优化版（考虑组合赔付）
        function calculateProfit() {
            try {
                // 获取投注量
                const dragonBet = parseInt(document.getElementById('dragonBet').value) || 0;
                const tigerBet = parseInt(document.getElementById('tigerBet').value) || 0;
                const tieBet = parseInt(document.getElementById('tieBet').value) || 0;
                const oddBet = parseInt(document.getElementById('oddBet').value) || 0;
                const evenBet = parseInt(document.getElementById('evenBet').value) || 0;
                const bigBet = parseInt(document.getElementById('bigBet').value) || 0;
                const smallBet = parseInt(document.getElementById('smallBet').value) || 0;
                const totalBet = parseInt(document.getElementById('totalBet').value) || 0;
                
                // 获取赔率
                const dragonOdds = parseFloat(odds.dragon.split(':')[1]);
                const tigerOdds = parseFloat(odds.tiger.split(':')[1]);
                const tieOdds = parseFloat(odds.tie.split(':')[1]);
                const oddOdds = parseFloat(odds.odd.split(':')[1]);
                const evenOdds = parseFloat(odds.even.split(':')[1]);
                const bigOdds = parseFloat(odds.big.split(':')[1]);
                const smallOdds = parseFloat(odds.small.split(':')[1]);
                const totalOdds = parseFloat(odds.total.split(':')[1]);
                
                // 总投注额
                const totalAmount = dragonBet + tigerBet + tieBet + oddBet + evenBet + bigBet + smallBet + totalBet;
                
                // 定义所有可能的开奖组合
                const combinations = [
                    { dragonTigerTie: 'dragon', oddEven: 'odd', bigSmall: 'big', total: 'any' },
                    { dragonTigerTie: 'dragon', oddEven: 'odd', bigSmall: 'small', total: 'any' },
                    { dragonTigerTie: 'dragon', oddEven: 'even', bigSmall: 'big', total: 'any' },
                    { dragonTigerTie: 'dragon', oddEven: 'even', bigSmall: 'small', total: 'any' },
                    { dragonTigerTie: 'tiger', oddEven: 'odd', bigSmall: 'big', total: 'any' },
                    { dragonTigerTie: 'tiger', oddEven: 'odd', bigSmall: 'small', total: 'any' },
                    { dragonTigerTie: 'tiger', oddEven: 'even', bigSmall: 'big', total: 'any' },
                    { dragonTigerTie: 'tiger', oddEven: 'even', bigSmall: 'small', total: 'any' },
                    { dragonTigerTie: 'tie', oddEven: 'odd', bigSmall: 'big', total: 'any' },
                    { dragonTigerTie: 'tie', oddEven: 'odd', bigSmall: 'small', total: 'any' },
                    { dragonTigerTie: 'tie', oddEven: 'even', bigSmall: 'big', total: 'any' },
                    { dragonTigerTie: 'tie', oddEven: 'even', bigSmall: 'small', total: 'any' }
                ];
                
                // 计算每个组合的盈利情况
                const results = [];
                let bestCombination = null;
                let bestProfit = -Infinity;
                let allLoss = true;
                
                for (const combo of combinations) {
                    // 计算赔付金额
                    let payout = 0;
                    
                    // 龙虎和赔付
                    if (combo.dragonTigerTie === 'dragon') {
                        payout += dragonBet * (1 + dragonOdds); // 包含本金
                    } else if (combo.dragonTigerTie === 'tiger') {
                        payout += tigerBet * (1 + tigerOdds);
                    } else if (combo.dragonTigerTie === 'tie') {
                        payout += tieBet * (1 + tieOdds);
                    }
                    
                    // 单双赔付
                    if (combo.oddEven === 'odd') {
                        payout += oddBet * (1 + oddOdds);
                    } else {
                        payout += evenBet * (1 + evenOdds);
                    }
                    
                    // 大小赔付
                    if (combo.bigSmall === 'big') {
                        payout += bigBet * (1 + bigOdds);
                    } else {
                        payout += smallBet * (1 + smallOdds);
                    }
                    
                    // 总和赔付（假设选择了一个没有投注的总和值）
                    payout += 0; // 暂时忽略总和赔付
                    
                    // 计算盈利
                    const profit = totalAmount - payout;
                    
                    // 记录结果
                    results.push({
                        combo,
                        payout,
                        profit
                    });
                    
                    // 更新最佳组合
                    if (profit > bestProfit) {
                        bestProfit = profit;
                        bestCombination = combo;
                    }
                    
                    // 检查是否所有组合都亏损
                    if (profit >= 0) {
                        allLoss = false;
                    }
                }
                
                // 计算最大亏损（最小盈利）
                let minProfit = Infinity;
                for (const result of results) {
                    if (result.profit < minProfit) {
                        minProfit = result.profit;
                    }
                }
                
                // 更新建议框
                const suggestionBox = document.getElementById('suggestionBox');
                const riskIndicator = document.getElementById('riskIndicator');
                const bestCombinationEl = document.getElementById('bestCombination');
                const combinationResult = document.getElementById('combinationResult');
                const recommendedNumber = document.getElementById('recommendedNumber');
                
                if (allLoss) {
                    riskIndicator.style.display = 'flex';
                    riskIndicator.className = 'risk-indicator danger';
                    document.getElementById('riskText').innerHTML = `
                        <strong>高风险警告：</strong> 所有开奖结果都会导致庄家亏损！<br>
                        建议开 <strong>${getComboName(bestCombination)}</strong> 将亏损最小化。
                    `;
                    document.getElementById('suggestionText').innerHTML = `亏损最小化建议：<strong>${getComboName(bestCombination)}</strong>`;
                } else {
                    riskIndicator.style.display = 'none';
                    document.getElementById('suggestionText').innerHTML = `开奖建议：<strong>${getComboName(bestCombination)}</strong> 最有利`;
                }
                
                document.getElementById('expectedProfit').textContent = `¥ ${bestProfit.toLocaleString()}`;
                document.getElementById('maxLoss').textContent = `¥ ${minProfit.toLocaleString()}`;
                
                // 显示最佳组合
                bestCombinationEl.style.display = 'block';
                combinationResult.innerHTML = `
                    <div class="combination-values">
                        <div class="combination-value" style="background: rgba(255, 107, 107, 0.3);">${bestCombination.dragonTigerTie === 'dragon' ? '龙' : bestCombination.dragonTigerTie === 'tiger' ? '虎' : '和'}</div>
                        <div class="combination-value" style="background: rgba(245, 158, 11, 0.3);">${bestCombination.oddEven === 'odd' ? '单' : '双'}</div>
                        <div class="combination-value" style="background: rgba(14, 165, 233, 0.3);">${bestCombination.bigSmall === 'big' ? '大' : '小'}</div>
                    </div>
                    <div style="margin-top: 10px;">此组合下庄家盈利: <span style="color: var(--success); font-weight: 600;">¥${bestProfit.toLocaleString()}</span></div>
                `;
                
                // 生成推荐号码
                recommendedNumber.textContent = generateRecommendedNumber(bestCombination);
                
                // 渲染结果详情
                const container = document.getElementById('resultDetails');
                container.innerHTML = '';
                
                for (let i = 0; i < results.length; i++) {
                    const result = results[i];
                    const isBest = result.combo === bestCombination;
                    const profitValue = result.profit;
                    const isProfit = profitValue >= 0;
                    
                    const card = document.createElement('div');
                    card.className = 'result-card';
                    if (isBest) card.classList.add('recommended');
                    
                    card.innerHTML = `
                        ${isBest ? '<div class="badge recommended">推荐</div>' : ''}
                        <div class="result-title">
                            <span>组合 ${i+1}: ${getComboName(result.combo)}</span>
                        </div>
                        <div class="profit ${isProfit ? 'positive' : 'negative'}">
                            ${isProfit ? '庄家盈利' : '庄家亏损'}: ${isProfit ? '+' : ''}¥${Math.abs(profitValue).toLocaleString()}
                        </div>
                        <div class="loss">
                            需赔付玩家: <span style="color: var(--danger); font-weight: 600;">¥${result.payout.toLocaleString()}</span>
                        </div>
                    `;
                    
                    container.appendChild(card);
                }
                
                // 更新系统数据
                systemData.todayTotalBet += totalAmount;
                systemData.todayProfit += bestProfit;
                systemData.totalBetAmount += totalAmount;
                systemData.totalProfit += bestProfit;
                
                // 添加历史记录
                const now = new Date();
                systemData.history.push({
                    period: document.getElementById('drawPeriod').value,
                    result: '',
                    totalAmount: totalAmount,
                    profit: bestProfit,
                    time: now.toLocaleString()
                });
                
                // 更新统计显示
                updateStatsDisplay();
                renderHistoryTable();
                
                // 重新渲染图表
                initChart();
                initProfitChart();
                
                showToast('盈利计算完成！');
            } catch (error) {
                console.error('计算盈利时出错:', error);
                showToast('计算过程中发生错误！', 'error');
            }
        }
        
        // 获取组合名称
        function getComboName(combo) {
            return `${combo.dragonTigerTie === 'dragon' ? '龙' : combo.dragonTigerTie === 'tiger' ? '虎' : '和'} + ${combo.oddEven === 'odd' ? '单' : '双'} + ${combo.bigSmall === 'big' ? '大' : '小'}`;
        }
        
        // 打开赔率设置面板
        function openOddsSelector(type) {
            try {
                document.getElementById('dragonOdds').value = odds.dragon;
                document.getElementById('tigerOdds').value = odds.tiger;
                document.getElementById('tieOdds').value = odds.tie;
                document.getElementById('oddOdds').value = odds.odd;
                document.getElementById('evenOdds').value = odds.even;
                document.getElementById('bigOdds').value = odds.big;
                document.getElementById('smallOdds').value = odds.small;
                document.getElementById('totalOdds').value = odds.total;
                
                document.getElementById('oddsSelector').classList.add('active');
            } catch (error) {
                console.error('打开赔率设置面板时出错:', error);
                showToast('无法打开赔率设置面板', 'error');
            }
        }
        
        // 保存赔率设置
        function saveOdds() {
            try {
                odds.dragon = document.getElementById('dragonOdds').value;
                odds.tiger = document.getElementById('tigerOdds').value;
                odds.tie = document.getElementById('tieOdds').value;
                odds.odd = document.getElementById('oddOdds').value;
                odds.even = document.getElementById('evenOdds').value;
                odds.big = document.getElementById('bigOdds').value;
                odds.small = document.getElementById('smallOdds').value;
                odds.total = document.getElementById('totalOdds').value;
                
                // 更新赔率按钮
                document.querySelectorAll('.odds-btn').forEach(btn => {
                    const type = btn.dataset.type;
                    btn.textContent = odds[type];
                });
                
                document.getElementById('oddsSelector').classList.remove('active');
                updatePayoutDisplay();
                calculateProfit();
                
                showToast('赔率设置已保存！');
            } catch (error) {
                console.error('保存赔率设置时出错:', error);
                showToast('保存赔率设置失败', 'error');
            }
        }
        
        // 保存开奖结果
        function saveDrawResult() {
            try {
                const result = document.getElementById('drawResult').value;
                const errorEl = document.getElementById('drawError');
                const errorMessage = document.getElementById('drawErrorMessage');
                
                if (result.length !== 5 || !/^\d+$/.test(result)) {
                    errorEl.style.display = 'block';
                    errorMessage.style.display = 'block';
                    errorMessage.innerHTML = `<i class="fas fa-exclamation-circle"></i> 开奖结果必须是5位数字`;
                    document.getElementById('drawResult').style.borderColor = 'rgba(239, 68, 68, 0.5)';
                    return;
                }
                
                errorEl.style.display = 'none';
                errorMessage.style.display = 'none';
                document.getElementById('drawResult').style.borderColor = 'rgba(16, 185, 129, 0.5)';
                
                // 更新开奖结果
                upcomingDraws[0].result = result;
                renderUpcomingDraws();
                
                // 重置输入
                document.getElementById('drawResult').value = '';
                
                // 更新期号 - 修复期号递增逻辑
                const currentPeriod = document.getElementById('drawPeriod').value;
                const periodNum = parseInt(currentPeriod);
                const periodLength = currentPeriod.length;
                const nextPeriod = (periodNum + 1).toString().padStart(periodLength, '0');
                document.getElementById('drawPeriod').value = nextPeriod;
                
                // 更新状态
                upcomingDraws[0].status = 'completed';
                
                // 如果还有下一期，更新为next
                if (upcomingDraws.length > 1) {
                    upcomingDraws[1].status = 'next';
                } else {
                    // 添加新的一期
                    const newPeriod = (parseInt(upcomingDraws[upcomingDraws.length - 1].period) + 1).toString().padStart(periodLength, '0');
                    upcomingDraws.push({
                        period: newPeriod,
                        result: '',
                        status: 'next'
                    });
                }
                
                renderUpcomingDraws();
                showToast('开奖结果已保存！');
            } catch (error) {
                console.error('保存开奖结果时出错:', error);
                showToast('保存开奖结果失败', 'error');
            }
        }
        
        // 随机生成开奖结果
        function generateRandomResult() {
            try {
                let result = '';
                for (let i = 0; i < 5; i++) {
                    result += Math.floor(Math.random() * 10);
                }
                document.getElementById('drawResult').value = result;
                document.getElementById('drawResult').dispatchEvent(new Event('input'));
                showToast('已生成随机开奖结果！');
            } catch (error) {
                console.error('生成随机开奖结果时出错:', error);
                showToast('生成随机结果失败', 'error');
            }
        }
        
        // 添加未来开奖
        function addFutureDraw() {
            try {
                const lastPeriod = upcomingDraws[upcomingDraws.length - 1].period;
                const periodLength = lastPeriod.length;
                const newPeriod = (parseInt(lastPeriod) + 1).toString().padStart(periodLength, '0');
                
                upcomingDraws.push({
                    period: newPeriod,
                    result: '',
                    status: 'pending'
                });
                
                renderUpcomingDraws();
                showToast('已添加未来开奖期号！');
            } catch (error) {
                console.error('添加未来开奖时出错:', error);
                showToast('添加未来开奖失败', 'error');
            }
        }
        
        // 清空设置
        function clearSettings() {
            showConfirmation('确认清空设置', '您确定要清空所有开奖设置吗？', function() {
                try {
                    // 保留第一条记录
                    while (upcomingDraws.length > 1) {
                        upcomingDraws.pop();
                    }
                    
                    // 重置第一条记录
                    upcomingDraws[0].result = '';
                    upcomingDraws[0].status = 'next';
                    
                    // 重置期号
                    document.getElementById('drawPeriod').value = '20230615001';
                    
                    renderUpcomingDraws();
                    showToast('开奖设置已清空！');
                } catch (error) {
                    console.error('清空设置时出错:', error);
                    showToast('清空设置失败', 'error');
                }
            });
        }
        
        // 清除所有投注量
        function clearAllBets() {
            try {
                document.getElementById('dragonBet').value = '0';
                document.getElementById('tigerBet').value = '0';
                document.getElementById('tieBet').value = '0';
                document.getElementById('oddBet').value = '0';
                document.getElementById('evenBet').value = '0';
                document.getElementById('bigBet').value = '0';
                document.getElementById('smallBet').value = '0';
                document.getElementById('totalBet').value = '0';
                
                updatePayoutDisplay();
                showToast('所有投注量已清除！');
            } catch (error) {
                console.error('清除投注量时出错:', error);
                showToast('清除投注量失败', 'error');
            }
        }
        
        // 更新统计显示
        function updateStatsDisplay() {
            document.getElementById('todayTotalBet').textContent = `¥ ${systemData.todayTotalBet.toLocaleString()}`;
            document.getElementById('todayProfit').textContent = `¥ ${systemData.todayProfit.toLocaleString()}`;
            document.getElementById('totalBetAmount').textContent = `¥ ${systemData.totalBetAmount.toLocaleString()}`;
            document.getElementById('totalProfit').textContent = `¥ ${systemData.totalProfit.toLocaleString()}`;
        }
        
        // 渲染历史记录表
        function renderHistoryTable() {
            const container = document.getElementById('historyTable');
            container.innerHTML = '';
            
            systemData.history.slice().reverse().forEach(record => {
                const row = document.createElement('tr');
                
                row.innerHTML = `
                    <td>${record.period}</td>
                    <td>${record.result || '待开奖'}</td>
                    <td>¥${record.totalAmount.toLocaleString()}</td>
                    <td style="color: ${record.profit >= 0 ? 'var(--success)' : 'var(--danger)'};">${record.profit >= 0 ? '+' : ''}¥${record.profit.toLocaleString()}</td>
                    <td>${record.time}</td>
                `;
                
                container.appendChild(row);
            });
        }
        
        // 初始化盈利图表
        function initProfitChart() {
            try {
                const ctx = document.getElementById('profitChart').getContext('2d');
                
                // 如果已有图表实例，先销毁
                if (profitChart) {
                    profitChart.destroy();
                }
                
                // 盈利数据（模拟最近7天）
                const profitData = {
                    labels: ['6天前', '5天前', '4天前', '3天前', '前天', '昨天', '今天'],
                    datasets: [{
                        label: '盈利',
                        data: [12000, 18000, 15000, 22000, 19000, 21000, systemData.todayProfit],
                        backgroundColor: 'rgba(16, 185, 129, 0.5)',
                        borderColor: 'rgba(16, 185, 129, 1)',
                        borderWidth: 2,
                        tension: 0.4,
                        fill: true
                    }]
                };
                
                // 创建图表
                profitChart = new Chart(ctx, {
                    type: 'line',
                    data: profitData,
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                grid: {
                                    color: 'rgba(255, 255, 255, 0.1)'
                                },
                                ticks: {
                                    color: 'rgba(255, 255, 255, 0.7)',
                                    callback: function(value) {
                                        return '¥' + value.toLocaleString();
                                    }
                                }
                            },
                            x: {
                                grid: {
                                    display: false
                                },
                                ticks: {
                                    color: 'rgba(255, 255, 255, 0.7)'
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        return `盈利: ¥${context.raw.toLocaleString()}`;
                                    }
                                }
                            }
                        }
                    }
                });
            } catch (error) {
                console.error('初始化盈利图表时出错:', error);
                showToast('初始化图表失败', 'error');
            }
        }
        
        // 初始化筛选功能
        function initFilters() {
            const timeFilter = document.getElementById('timeRangeFilter');
            const lotteryFilter = document.getElementById('lotteryTypeFilter');
            const betFilter = document.getElementById('betTypeFilter');
            const errorMessage = document.getElementById('analyticsErrorMessage');
            
            function applyFilters() {
                try {
                    const timeValue = timeFilter.value;
                    const lotteryValue = lotteryFilter.value;
                    const betValue = betFilter.value;
                    
                    // 模拟筛选逻辑
                    if (timeValue === '最近7天' && lotteryValue === '全部' && betValue === '全部') {
                        errorMessage.style.display = 'none';
                        showToast('筛选条件已应用');
                    } else {
                        errorMessage.style.display = 'block';
                    }
                } catch (error) {
                    console.error('应用筛选时出错:', error);
                    showToast('应用筛选失败', 'error');
                }
            }
            
            timeFilter.addEventListener('change', applyFilters);
            lotteryFilter.addEventListener('change', applyFilters);
            betFilter.addEventListener('change', applyFilters);
        }
        
        // 切换内容面板
        function switchPanel(panelId) {
            try {
                // 隐藏所有面板
                document.querySelectorAll('.content-panel').forEach(panel => {
                    panel.classList.remove('active');
                });
                
                // 显示选中的面板
                document.getElementById(panelId).classList.add('active');
                
                // 更新导航活动状态
                document.querySelectorAll('.nav-item').forEach(item => {
                    item.classList.remove('active');
                });
                
                // 设置当前活动项
                document.querySelector(`.nav-item[data-panel="${panelId}"]`).classList.add('active');
                
                // 更新标题
                const panelTitle = document.querySelector(`.nav-item[data-panel="${panelId}"] span`).textContent;
                document.querySelector('.header h2').innerHTML = `<i class="fas fa-${panelId === 'dashboard' ? 'tachometer-alt' : panelId === 'drawManagement' ? 'dice' : panelId === 'history' ? 'history' : panelId === 'analytics' ? 'chart-line' : panelId === 'dragonAlert' ? 'dragon' : panelId === 'oddsCalculator' ? 'calculator' : 'cog'}"></i> ${panelTitle}`;
                
                // 初始化特定面板的图表
                if (panelId === 'dashboard') {
                    initProfitChart();
                } else if (panelId === 'analytics') {
                    initChart();
                }
                
                // 在移动设备上关闭侧边栏
                if (window.innerWidth < 992) {
                    document.getElementById('sidebar').classList.remove('active');
                }
            } catch (error) {
                console.error('切换面板时出错:', error);
                showToast('切换面板失败', 'error');
            }
        }
        
        // 事件监听
        document.addEventListener('DOMContentLoaded', function() {
            // 渲染初始数据
            renderUpcomingDraws();
            updatePayoutDisplay();
            initChart();
            initProfitChart();
            updateStatsDisplay();
            renderHistoryTable();
            initFilters();
            
            // 设置赔率按钮显示
            document.querySelectorAll('.odds-btn').forEach(btn => {
                const type = btn.dataset.type;
                btn.textContent = odds[type];
            });
            
            // 开奖结果输入验证
            document.getElementById('drawResult').addEventListener('input', function() {
                const value = this.value;
                const errorEl = document.getElementById('drawError');
                const errorMessage = document.getElementById('drawErrorMessage');
                
                if (value.length === 5 && /^\d+$/.test(value)) {
                    this.style.borderColor = 'rgba(16, 185, 129, 0.5)';
                    errorEl.style.display = 'none';
                    errorMessage.style.display = 'none';
                } else if (value.length > 0) {
                    this.style.borderColor = 'rgba(239, 68, 68, 0.5)';
                    errorEl.style.display = 'block';
                    errorMessage.style.display = 'block';
                    errorMessage.innerHTML = `<i class="fas fa-exclamation-circle"></i> 开奖结果必须是5位数字`;
                } else {
                    this.style.borderColor = 'rgba(255, 255, 255, 0.1)';
                    errorEl.style.display = 'none';
                    errorMessage.style.display = 'none';
                }
            });
            
            // 绑定投注量输入事件
            const betInputs = document.querySelectorAll('.bet-input input[type="number"]');
            betInputs.forEach(input => {
                input.addEventListener('input', updatePayoutDisplay);
            });
            
            // 绑定按钮事件
            document.getElementById('saveDrawBtn').addEventListener('click', saveDrawResult);
            document.getElementById('randomDrawBtn').addEventListener('click', generateRandomResult);
            document.getElementById('calculateBtn').addEventListener('click', calculateProfit);
            document.getElementById('saveOddsBtn').addEventListener('click', saveOdds);
            document.getElementById('closeOddsBtn').addEventListener('click', function() {
                document.getElementById('oddsSelector').classList.remove('active');
            });
            document.getElementById('addFutureDrawBtn').addEventListener('click', addFutureDraw);
            document.getElementById('clearSettingsBtn').addEventListener('click', clearSettings);
            document.getElementById('clearBetsBtn').addEventListener('click', clearAllBets);
            
            // 绑定赔率按钮事件
            document.querySelectorAll('.odds-btn').forEach(btn => {
                btn.addEventListener('click', () => openOddsSelector(btn.dataset.type));
            });
            
            // 点击赔率选择器背景关闭
            document.getElementById('oddsSelector').addEventListener('click', function(e) {
                if (e.target === this) {
                    this.classList.remove('active');
                }
            });
            
            // 绑定导航点击事件
            document.querySelectorAll('.nav-item').forEach(item => {
                item.addEventListener('click', function() {
                    const panelId = this.getAttribute('data-panel');
                    switchPanel(panelId);
                });
            });
            
            // 移动端菜单按钮
            document.getElementById('mobileMenuBtn').addEventListener('click', function() {
                document.getElementById('sidebar').classList.toggle('active');
            });
            
            // 初始计算
            setTimeout(calculateProfit, 500);
        });
    </script>
</body>
</html>